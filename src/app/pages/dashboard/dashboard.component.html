<div class="layout" [class.no-sidebar]="!sidebarOpen()">
  <app-sidebar *ngIf="sidebarOpen()"></app-sidebar>
  <section class="content">
    <header class="topbar">
      <button class="menu" (click)="toggleSidebar()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <h1>Dashboard</h1>
      <div class="actions">
        <button class="action-btn" (click)="notifyClick()">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 3a6 6 0 0 1 6 6v3.586l1.707 1.707A1 1 0 0 1 19.586 16H4.414a1 1 0 0 1-.707-1.707L5.414 12.586V9a6 6 0 0 1 6-6Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 18a3 3 0 0 0 6 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </header>

    <div class="cards">
      <app-info-card 
        title="Total de Contas na Carteira" 
        [value]="totalContasDoGerente()" 
        iconClass="icon-users"
        actionTooltip="Ver listagem"
        [isPositive]="true"
        (action)="onTotalContasTableOpen()">
      </app-info-card>

      <app-graph-card 
        title="Distribuição de Produtos"
        type="pie"
        dataType="percent"
        [values]="[10,40,50]"
        [labels]="['PIX','CARTÃO CRÉDITO','OUTROS']"
        [actionChartAreas]="[actionPIXArea, actionCREDITOArea, actionOUTROSArea]">
      </app-graph-card>

      <app-info-card 
        title="Gap de Produtos: PIX" 
        [value]="percentualClientesPIX() + '%'" 
        [trend]="totalContratosPIXDoGerente()" 
        description="Clientes com PIX"
        actionTooltip="Ver listagem"
        iconClass="icon-qrcode"
        [isPositive]="percentualClientesPIX() > 0"
        (action)="openContatosPIXTableOpen()">
      </app-info-card>

      <app-info-card 
        title="Gap de Produtos: CARTÃO CRÉDITO" 
         [value]="percentualClientesCREDITO() + '%'" 
        [trend]="totalContratosCREDITODoGerente()" 
        description="Clientes com CREDITO"
        actionTooltip="Ver listagem"
        iconClass="icon-card"
        [isPositive]="true"
        (action)="openContatosCREDITOTableOpen()">
      </app-info-card>

      <app-info-card 
        title="Tarefas Pendentes" 
        value="23" 
        trend="Vencendo hoje"
        description=""
        iconClass="icon-check"
        [isPositive]="false"
        (action)="onTasksCardAction()">
      </app-info-card>
    </div>

    <div class="panel performance" *ngIf="!showContasTable() && !showContratosPIXTable() && !showContratosCREDITOTable()">
      <h2>Performance de Vendas</h2>
      <p>Receita mensal vs Meta</p>
    </div>

    <app-paginated-table 
      *ngIf="showContasTable()"
      title="Contas da Carteira"
      [rows]="contas()"
      [columns]="contasColumns"
      [pageSize]="10"
      (close)="closeContasTable()"
    ></app-paginated-table>

    <app-paginated-table 
      *ngIf="showContratosPIXTable()"
      title="Contratos PIX"
      [rows]="contratosPIX()"
      [columns]="contratoColumns"
      [pageSize]="10"
      (close)="closeContratosPIXTable()"
    ></app-paginated-table>

    <app-paginated-table 
      *ngIf="showContratosCREDITOTable()"
      title="Contratos CARTÃO CRÉDITO"
      [rows]="contratosCREDITO()"
      [columns]="contratoColumns"
      [pageSize]="10"
      (close)="closeContratosCREDITOTable()"
    ></app-paginated-table>
  </section>
</div>
